# API配置界面使用指南

**文件名(File):** api_config_ui.md  
**版本(Version):** v1.0.0  
**作者(Author):** 深圳王哥 & AI  
**创建日期(Created):** 2025/7/25  
**简介(Description):** API配置图形界面的详细使用说明

---

## 界面概览

API配置界面采用现代化的Material Design风格，支持桌面和手机系统，提供直观易用的配置体验。

### 界面布局

```
┌─────────────────────────────────────┐
│        Translate-Chat API配置        │
├─────────────────────────────────────┤
│  ┌─────────────────────────────────┐ │
│  │        欢迎使用卡片              │ │
│  └─────────────────────────────────┘ │
│  ┌─────────────────────────────────┐ │
│  │      语音识别 (ASR) 配置         │ │
│  │  ┌─────────────────────────────┐ │ │
│  │  │ ASR_APP_ID (必填)           │ │ │
│  │  └─────────────────────────────┘ │ │
│  │  ┌─────────────────────────────┐ │ │
│  │  │ ASR_ACCESS_KEY (必填)        │ │ │
│  │  └─────────────────────────────┘ │ │
│  └─────────────────────────────────┘ │
│  ┌─────────────────────────────────┐ │
│  │      大语言模型 (LLM) 配置       │ │
│  │  ┌─────────────────────────────┐ │ │
│  │  │ LLM_API_KEY (必填)           │ │ │
│  │  └─────────────────────────────┘ │ │
│  └─────────────────────────────────┘ │
│  ┌─────────────────────────────────┐ │
│  │    [保存配置]    [检查配置]      │ │
│  └─────────────────────────────────┘ │
│  ┌─────────────────────────────────┐ │
│  │        配置状态显示              │ │
│  └─────────────────────────────────┘ │
│  ┌─────────────────────────────────┐ │
│  │        帮助信息                  │ │
│  └─────────────────────────────────┘ │
│  ┌─────────────────────────────────┐ │
│  │     [开始使用 Translate-Chat]    │ │
│  └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

---

## 功能说明

### 1. 配置输入区域

#### ASR配置组
- **ASR_APP_ID**: 火山引擎ASR应用ID（必填）
- **ASR_ACCESS_KEY**: 火山引擎访问密钥（必填）

#### LLM配置组
- **LLM_API_KEY**: 大语言模型API密钥（必填）

### 2. 操作按钮

#### 保存配置
- 验证所有必填项
- 自动备份原配置文件
- 保存到环境变量
- 显示成功/错误提示

#### 检查配置
- 检查环境变量状态
- 检查配置文件状态
- 显示详细的配置检查结果

### 3. 状态显示

实时显示配置状态：
- ✅ 配置完整，可以正常使用
- ⚠️ 配置不完整，请补充缺失的配置项
- ❌ 未配置，请填写API密钥信息

### 4. 帮助功能

- **获取API密钥指南**: 提供详细的获取步骤
- **火山引擎控制台链接**: 一键打开控制台
- **开始使用按钮**: 配置完成后启动主应用

---

## 使用步骤

### 第一步：启动配置界面
```bash
python3 setup_api.py
```

### 第二步：填写API密钥
1. 在ASR配置区域填写：
   - ASR_APP_ID
   - ASR_ACCESS_KEY

2. 在LLM配置区域填写：
   - LLM_API_KEY

### 第三步：保存配置
1. 点击"保存配置"按钮
2. 系统会验证必填项
3. 自动保存到环境变量
4. 显示成功提示

### 第四步：验证配置
1. 点击"检查配置"按钮
2. 查看配置状态
3. 确认所有项目都已正确设置

### 第五步：开始使用
1. 配置完成后，点击"开始使用 Translate-Chat"
2. 运行主应用：`python3 main.py`

---

## 平台兼容性

### 桌面系统
- **macOS**: 支持zsh和bash shell
- **Linux**: 支持bash和zsh shell
- **Windows**: 支持PowerShell和CMD

### 移动系统
- **Android**: 支持Termux环境

### 配置文件位置
- **macOS**: `~/.zshrc` 或 `~/.bash_profile`
- **Linux**: `~/.zshrc` 或 `~/.bashrc`
- **Android**: `~/.bashrc`

---

## 错误处理

### 常见错误及解决方案

#### 1. 依赖缺失
```
❌ 缺少KivyMD依赖
请运行: pip install kivymd==1.1.1
```

#### 2. 必填项未填写
```
错误: 请填写所有必填项
```
**解决**: 确保ASR_APP_ID、ASR_ACCESS_KEY、LLM_API_KEY都已填写

#### 3. 保存失败
```
错误: 保存配置失败: [具体错误信息]
```
**解决**: 检查文件权限或使用命令行配置方式

#### 4. 配置不完整
```
⚠️ 配置不完整，请补充缺失的配置项
```
**解决**: 使用"检查配置"功能查看具体缺失的项目

---

## 备选方案

如果图形界面无法使用，可以使用以下备选方案：

### 1. 命令行配置
```bash
bash scripts/setup_env.sh -i
```

### 2. 手动设置环境变量
```bash
export ASR_APP_ID="你的密钥"
export ASR_ACCESS_KEY="你的密钥"
export LLM_API_KEY="你的密钥"
```

### 3. 编辑配置文件
```bash
# 使用环境变量配置（推荐）
# 或使用 setup_config.py 图形界面配置
```

---

## 中文字体支持

### 字体配置
系统使用 Noto Sans SC 字体来支持中文显示：
- **字体文件**: `assets/fonts/NotoSansSC-VariableFont_wght.ttf`
- **自动注册**: 应用启动时自动注册中文字体
- **回退机制**: 如果字体文件不存在，使用系统默认字体

### 字体问题排查
如果中文显示为方块或"XXXX"：
1. 检查字体文件是否存在
2. 确认字体文件路径正确
3. 重启应用

## 技术支持

如有问题，请联系：manwjh@126.com 